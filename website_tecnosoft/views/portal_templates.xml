<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Custom Portal Dashboard -->
    <template id="tecnosoft_portal_my_home" inherit_id="portal.portal_my_home" name="Tecnosoft Portal Dashboard">
        <xpath expr="//div[hasclass('o_portal_my_home')]" position="attributes">
            <attribute name="class" add="tecnosoft-portal-dashboard row g-4" separator=" "/>
        </xpath>
        <xpath expr="//div[hasclass('o_portal_docs')]" position="attributes">
            <attribute name="class" add="col-12" separator=" "/>
        </xpath>
    </template>

    <!-- Enhance Portal Layout with Sidebar/Card style -->
    <template id="tecnosoft_portal_layout" inherit_id="portal.portal_layout" name="Tecnosoft Portal Layout">
        <xpath expr="//div[descendant::t[@t-call='portal.side_content']][1]" position="attributes">
            <attribute name="class" add="sticky-top" separator=" "/>
        </xpath>
        <xpath expr="//div[contains(@t-attf-class, 'o_portal_content')]" position="attributes">
            <attribute name="class" add="ps-lg-5" separator=" "/>
        </xpath>
    </template>

    <!-- Custom Portal Home Icons and Cards -->
    <template id="tecnosoft_portal_home_card" inherit_id="portal.portal_my_home" name="Tecnosoft Portal Cards" priority="20">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="before">
            <div class="col-12 mb-4">
                <div class="tecnosoft-portal-welcome p-5 bg-primary text-white rounded-4 shadow-sm position-relative overflow-hidden">
                    <div class="position-relative z-index-1">
                        <h2 class="fw-bold">Bienvenido, <t t-esc="request.env.user.partner_id.name"/></h2>
                        <p class="lead mb-0 opacity-75">Gestiona tus pedidos, facturas y preferencias desde tu panel profesional.</p>
                    </div>
                    <i class="fa fa-user-circle position-absolute end-0 bottom-0 opacity-25 m-n4" style="font-size: 15rem;"></i>
                </div>
            </div>
        </xpath>
    </template>

    <!-- Add Reorder Button to Portal Order List -->
    <template id="portal_my_orders_reorder" inherit_id="website_sale.portal_my_orders" name="Tecnosoft Portal Reorder">
        <xpath expr="//t[@t-foreach='orders']//td[hasclass('text-end')]" position="inside">
            <a t-attf-href="/shop/reorder/#{order.id}" class="btn btn-secondary btn-sm rounded-pill ms-2" title="Volver a pedir">
                <i class="fa fa-refresh"></i>
            </a>
        </xpath>
    </template>

    <!-- Add Reorder Button to Portal Order Detail -->
    <template id="portal_order_page_reorder" inherit_id="website_sale.portal_order_page" name="Tecnosoft Portal Order Reorder">
        <xpath expr="//div[@id='portal_order_content']//h2" position="inside">
            <a t-attf-href="/shop/reorder/#{order.id}" class="btn btn-primary rounded-pill float-end small fw-bold">
                <i class="fa fa-refresh me-1"></i> REPETIR PEDIDO
            </a>
        </xpath>
    </template>
</odoo>
