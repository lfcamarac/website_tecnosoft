<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- QUICK VIEW MODAL CONTENT -->
    <template id="quick_view_modal" name="Quick View Content">
        <div class="product-quick-view-container position-relative bg-white rounded-4 shadow-lg overflow-hidden border-0">
            <button type="button" class="btn-close position-absolute top-0 end-0 m-4 z-index-10 shadow-sm bg-white rounded-circle p-2" data-bs-dismiss="modal" aria-label="Close" style="width: 32px; height: 32px;"></button>
            <div class="row g-0">
                <!-- Product Image Gallery Section -->
                <div class="col-md-7 bg-light d-flex align-items-center justify-content-center border-end overflow-hidden position-relative">
                    <div class="quick-view-badge position-absolute top-0 start-0 m-4 shadow-sm" t-if="product.brand_id">
                        <span class="badge bg-white text-primary px-3 py-2 rounded-pill fw-bold" t-esc="product.brand_id.name"/>
                    </div>
                    <div class="p-4 w-100 text-center">
                        <img t-if="product.image_1920" 
                             t-att-src="'/web/image/product.template/%s/image_1024' % product.id" 
                             class="img-fluid object-contain main-quick-view-img" 
                             style="max-height: 550px; transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);" 
                             alt="Product Image"/>
                        <span t-else="" class="text-muted fa fa-camera fa-5x"></span>
                    </div>
                </div>
                <!-- Product Details & Configurator Section -->
                <div class="col-md-5 d-flex flex-column">
                    <div class="p-5 flex-grow-1 overflow-auto" style="max-height: 80vh;">
                        <nav aria-label="breadcrumb" class="mb-2">
                            <ol class="breadcrumb mb-0 small text-uppercase fw-bold opacity-75">
                                <li class="breadcrumb-item"><a href="/shop" class="text-decoration-none text-secondary">Tienda</a></li>
                                <li t-if="product.public_categ_ids" class="breadcrumb-item active" t-esc="product.public_categ_ids[0].name"/>
                            </ol>
                        </nav>
                        
                        <h2 class="fw-bold mb-3 text-dark lh-sm" t-field="product.name"/>
                        
                        <div class="d-flex align-items-center gap-3 mb-4 border-bottom pb-4">
                            <h3 class="text-primary fw-bold mb-0" t-field="product.list_price" 
                                t-options="{'widget': 'monetary', 'display_currency': product.currency_id}"/>
                            <span t-if="product.compare_list_price &gt; product.list_price" class="text-muted text-decoration-line-through small" t-field="product.compare_list_price" t-options="{'widget': 'monetary', 'display_currency': product.currency_id}"/>
                        </div>

                        <div class="text-muted mb-4 small lh-base" t-field="product.description_sale"/>
                        
                        <!-- ADD TO CART FORM -->
                        <form t-if="product._is_add_to_cart_possible()" action="/shop/cart/update" method="POST" class="js_add_cart_variants">
                            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
                            <input type="hidden" name="product_id" t-att-value="product.product_variant_id.id"/>
                            
                            <!-- Variant Selectors Slot (Uses Odoo Configurator logic if available) -->
                            <div class="js_product mb-4">
                                <t t-call="website_sale.variants">
                                    <t t-set="ul_class" t-value="'flex-column'"/>
                                    <t t-set="parent_combination" t-value="None"/>
                                </t>
                            </div>

                            <div class="d-grid gap-3 mb-4">
                                <div class="d-flex align-items-center gap-2">
                                    <div class="input-group input-group-lg border rounded-pill overflow-hidden bg-light" style="max-width: 130px;">
                                        <button type="button" class="btn btn-link py-1 px-3 text-dark js_add_cart_json" style="text-decoration: none;">
                                            <i class="fa fa-minus"></i>
                                        </button>
                                        <input type="text" class="form-control border-0 bg-transparent text-center quantity fw-bold p-0" data-min="1" name="add_qty" value="1"/>
                                        <button type="button" class="btn btn-link py-1 px-3 text-dark js_add_cart_json" style="text-decoration: none;">
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                    <button type="submit" class="btn btn-primary btn-lg rounded-pill flex-grow-1 fw-bold shadow-sm d-flex align-items-center justify-content-center gap-2">
                                        <i class="fa fa-shopping-cart"></i> Añadir al Carrito
                                    </button>
                                </div>
                                <div class="d-flex gap-2">
                                    <button type="button" class="btn btn-outline-secondary rounded-pill flex-grow-1 py-2 js_add_wishlist" t-att-data-product-template-id="product.id">
                                        <i class="fa fa-heart-o me-1"></i> Lista de Deseos
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary rounded-pill flex-grow-1 py-2 js_add_compare" t-att-data-product-id="product.id">
                                        <i class="fa fa-exchange me-1"></i> Comparar
                                    </button>
                                </div>
                            </div>
                        </form>
                        <div t-else="" class="alert alert-soft-warning border-0 rounded-4 p-4 text-center">
                            <i class="fa fa-info-circle mb-2 fa-2x d-block"></i>
                            <span class="fw-bold">Sin Stock</span>
                            <p class="small mb-0 mt-1 text-muted">Aviso de disponibilidad próximamente.</p>
                        </div>
                    </div>
                    
                    <div class="p-4 border-top bg-light text-center mt-auto">
                        <a t-att-href="product.website_url" class="btn btn-link text-decoration-none text-dark fw-bold">
                            VER FICHA COMPLETA <i class="fa fa-chevron-right ms-2 small"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </template>
</odoo>
